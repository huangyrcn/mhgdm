# Letter_high å®Œæ•´è®­ç»ƒæ›²çº¿é…ç½® - ç¦ç”¨æ—©åœæœºåˆ¶
# ç”¨äºè§‚å¯Ÿè®­ç»ƒçš„æ”¶æ•›å’Œå‘æ•£ç¨‹åº¦

# å®éªŒåŸºæœ¬ä¿¡æ¯
exp_name: "letter_high_no_early_stop"
timestamp: "${now}"
run_name: "${exp_name}_${timestamp}"
debug: false
seed: 42
device: "auto"

# æ•°æ®é›†é…ç½®
data:
  name: "Letter_high"
  batch_size: 128
  max_feat_num: 5
  max_node_num: 9
  test_class_num: 4  # æµ‹è¯•ç±»åˆ«ï¼š[4,6,11,8]
  train_class_num: 11  # è®­ç»ƒç±»åˆ«ï¼š[1,9,10,2,0,3,14,5,12,13,7]
  test_split: 0.2

# FSLä»»åŠ¡é…ç½®
fsl_task:
  N_way: 4  # 4ä¸ªæµ‹è¯•ç±»åˆ«
  K_shot: 5
  R_query: 10

# Wandbé…ç½®
wandb:
  project: "MHGDM_LetterHigh_Full_Curve"
  entity: "huangyr_team"
  online: true
  no_wandb: false

# ==================== VAEé…ç½® - å®Œæ•´è®­ç»ƒç‰ˆ ====================
vae:
  # ç¼–ç å™¨é…ç½® - å¢å¼ºæ­£åˆ™åŒ–
  encoder:
    type: "HyperbolicGraphEncoder"
    manifold_type: "PoincareBall"
    layer_type: "HGAT"
    curvature: 1.0
    learnable_curvature: false
    num_layers: 3
    hidden_feature_dim: 32
    latent_feature_dim: 16
    input_feature_dim: 5
    dropout: 0.2  # å¢åŠ dropouté˜²æ­¢è¿‡æ‹Ÿåˆ
    aggregation_method: "sum"
    use_normalization: "ln"
  
  # è§£ç å™¨é…ç½® - å¢å¼ºæ­£åˆ™åŒ–
  decoder:
    type: "HyperbolicGraphDecoder"
    manifold_type: "PoincareBall"
    layer_type: "HGAT"
    curvature: 1.0
    learnable_curvature: false
    num_layers: 3
    hidden_feature_dim: 32
    latent_feature_dim: 16
    output_feature_dim: 5
    dropout: 0.2  # å¢åŠ dropouté˜²æ­¢è¿‡æ‹Ÿåˆ
    aggregation_method: "sum"
    use_normalization: "ln"
    use_centroid: false
  
  # æŸå¤±é…ç½®
  loss:
    pred_node_class: true
    pred_edge: false
    pred_graph_class: false
    use_kl_loss: true
    use_base_proto_loss: false
    use_sep_proto_loss: false
  
  # è®­ç»ƒé…ç½® - å®Œæ•´è®­ç»ƒç‰ˆ
  train:
    num_epochs: 200  # å‡å°‘epochæ•°ï¼Œè§‚å¯Ÿå®Œæ•´æ›²çº¿
    
    # å­¦ä¹ ç‡ä¼˜åŒ–
    lr: 0.0005  # é™ä½å­¦ä¹ ç‡
    lr_decay: 0.95  # æ›´å¿«è¡°å‡
    lr_schedule: true
    scheduler_type: "cosine"  # ä½¿ç”¨Cosine Annealing
    warmup_epochs: 10  # å‰10ä¸ªepochè¿›è¡Œwarm-up
    
    # æ­£åˆ™åŒ–å¼ºåŒ–
    weight_decay: 0.001  # å¢åŠ æƒé‡è¡°å‡
    grad_norm: 0.5  # æ›´ä¸¥æ ¼çš„æ¢¯åº¦è£å‰ª
    
    # æ—©åœé…ç½® - å…³é”®ï¼šç¦ç”¨æ—©åœ
    enable_early_stopping: false  # ğŸ”¥ ç¦ç”¨æ—©åœæœºåˆ¶ï¼Œè§‚å¯Ÿå®Œæ•´è®­ç»ƒæ›²çº¿
    early_stop_patience: 5  # å¤‡ç”¨å‚æ•°
    early_stop_min_delta: 0.01  # å¤‡ç”¨å‚æ•°
    
    # æŸå¤±æƒé‡ - å¢å¼ºKLæ­£åˆ™åŒ–
    rec_weight: 1.0
    kl_regularization: 0.001  # å¢åŠ KLæ­£åˆ™åŒ–
    edge_weight: 0.01
    graph_classification_weight: 0.0
    base_proto_weight: 0.0
    sep_proto_weight: 0.0
    
    # æµ‹è¯•é—´éš” - æ›´é¢‘ç¹è®°å½•
    test_interval: 1  # æ¯ä¸ªepochéƒ½æµ‹è¯•ï¼Œè·å¾—è¯¦ç»†æ›²çº¿

# ==================== è·¯å¾„é…ç½® ====================
paths:
  save_dir: "./checkpoints/Letter_high_no_early_stop" 